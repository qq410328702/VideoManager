<Window x:Class="VideoManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:views="clr-namespace:VideoManager.Views"
        mc:Ignorable="d"
        Title="Video Manager"
        Height="720" Width="1280"
        MinHeight="480" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource MaterialDesignWindow}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="14"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ==================== Top Search Bar ==================== -->
        <md:Card Grid.Row="0" Margin="8,8,8,4" Padding="8"
                 md:ElevationAssist.Elevation="Dp2"
                 UniformCornerRadius="4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBox Grid.Column="0"
                         x:Name="SearchKeywordTextBox"
                         Text="{Binding SearchKeyword, UpdateSourceTrigger=PropertyChanged}"
                         md:HintAssist.Hint="搜索视频标题或描述..."
                         md:HintAssist.IsFloating="False"
                         md:TextFieldAssist.HasClearButton="True"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Margin="0,0,8,0"
                         VerticalAlignment="Center"
                         FontSize="14"/>

                <Button Grid.Column="1"
                        Command="{Binding SearchCommand}"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        Margin="0,0,4,0"
                        ToolTip="搜索"
                        VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <md:PackIcon Kind="Magnify" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="搜索" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button Grid.Column="2"
                        Command="{Binding ClearFiltersCommand}"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        ToolTip="清除筛选条件"
                        VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <md:PackIcon Kind="FilterRemove" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="清除" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>
        </md:Card>

        <!-- ==================== Main Content Area ==================== -->
        <Grid Grid.Row="1" Margin="8,4,8,4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250" MinWidth="180"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: CategoryPanel UserControl -->
            <views:CategoryPanel x:Name="CategoryPanelControl" Grid.Column="0" Margin="0,0,4,0"/>

            <!-- Grid Splitter -->
            <GridSplitter Grid.Column="1"
                          Width="4"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Stretch"
                          Background="Transparent"
                          Cursor="SizeWE"/>

            <!-- Right Panel: Video List -->
            <md:Card Grid.Column="2"
                     md:ElevationAssist.Elevation="Dp1"
                     UniformCornerRadius="4"
                     Margin="4,0,0,0">
                <DockPanel>
                    <!-- Video list header with sort controls and pagination -->
                    <Border DockPanel.Dock="Top"
                            Background="{DynamicResource PrimaryHueMidBrush}"
                            Padding="12,10">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Title -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <md:PackIcon Kind="Video"
                                             Foreground="White"
                                             VerticalAlignment="Center"
                                             Width="20" Height="20"
                                             Margin="0,0,8,0"/>
                                <TextBlock x:Name="VideoListTitle"
                                           Text="视频列表"
                                           Foreground="White"
                                           FontSize="16"
                                           FontWeight="Medium"
                                           VerticalAlignment="Center"/>
                            </StackPanel>

                            <!-- Sort Controls -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">
                                <TextBlock Text="排序:"
                                           Foreground="White"
                                           VerticalAlignment="Center"
                                           Margin="0,0,6,0"
                                           FontSize="13"/>
                                <ComboBox x:Name="SortFieldComboBox"
                                          SelectedIndex="{Binding CurrentSortField, Converter={StaticResource SortFieldToIndexConverter}}"
                                          Style="{StaticResource MaterialDesignComboBox}"
                                          Foreground="White"
                                          FontSize="13"
                                          MinWidth="100"
                                          VerticalAlignment="Center"
                                          Margin="0,0,4,0"
                                          md:HintAssist.Foreground="White"
                                          md:TextFieldAssist.UnderlineBrush="White">
                                    <ComboBoxItem Content="导入日期"/>
                                    <ComboBoxItem Content="时长"/>
                                    <ComboBoxItem Content="文件大小"/>
                                </ComboBox>
                                <Button Command="{Binding ToggleSortDirectionCommand}"
                                        Style="{StaticResource MaterialDesignIconForegroundButton}"
                                        Foreground="White"
                                        ToolTip="{Binding CurrentSortDirection, Converter={StaticResource SortDirectionToTooltipConverter}}"
                                        Padding="4"
                                        VerticalAlignment="Center">
                                    <md:PackIcon Kind="{Binding CurrentSortDirection, Converter={StaticResource SortDirectionToIconConverter}}"
                                                 Width="20" Height="20"/>
                                </Button>
                            </StackPanel>

                            <!-- Pagination -->
                            <StackPanel Grid.Column="2" Orientation="Horizontal"
                                        VerticalAlignment="Center">
                                <Button Command="{Binding PreviousPageCommand}"
                                        Style="{StaticResource MaterialDesignIconForegroundButton}"
                                        Foreground="White"
                                        ToolTip="上一页"
                                        Padding="4">
                                    <md:PackIcon Kind="ChevronLeft" Width="20" Height="20"/>
                                </Button>
                                <TextBlock Text="{Binding PageInfoText}"
                                           Foreground="White"
                                           VerticalAlignment="Center"
                                           Margin="8,0"/>
                                <Button Command="{Binding NextPageCommand}"
                                        Style="{StaticResource MaterialDesignIconForegroundButton}"
                                        Foreground="White"
                                        ToolTip="下一页"
                                        Padding="4">
                                    <md:PackIcon Kind="ChevronRight" Width="20" Height="20"/>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- VideoListView UserControl -->
                    <views:VideoListView x:Name="VideoListControl"/>
                </DockPanel>
            </md:Card>
        </Grid>

        <!-- ==================== Bottom Toolbar ==================== -->
        <md:Card Grid.Row="2" Margin="8,4,8,8" Padding="8,6"
                 md:ElevationAssist.Elevation="Dp2"
                 UniformCornerRadius="4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Button x:Name="ImportButton"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            ToolTip="导入视频"
                            Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Kind="Import" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBlock Text="导入视频" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding RefreshCommand}"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            ToolTip="刷新列表"
                            Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Kind="Refresh" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBlock Text="刷新" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <TextBlock Grid.Column="1"
                           Text="{Binding StatusText}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                           FontSize="12"/>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button x:Name="SettingsButton"
                            Style="{StaticResource MaterialDesignIconButton}"
                            ToolTip="设置">
                        <md:PackIcon Kind="Cog" Width="22" Height="22"/>
                    </Button>
                </StackPanel>
            </Grid>
        </md:Card>
    </Grid>
</Window>
